pipeline {
  agent {
    docker {
      label 'static'
      image 'docker-registry.rdti.com/com.redi/builder:0.9'
      args '-v /var/run/docker.sock:/var/run/docker.sock --group-add 992'
    }
  }

  stages {
    stage('Git Clone') {
      steps {
        ansiColor('xterm') {
          checkout scm
        }
      }  
    }
      
    stage ('Package') {
      steps {
        sh '''
	  ${WORKSPACE}/build.sh --pack_helm --push_helm --helm_repo ${HELM_REPO} --helm_usr ${HELM_USR} --helm_psw ${HELM_PSW}
          #helm repo add artifactory https://artifactory.rdti.com/artifactory/helm-local
 	  #helm repo update
          #helm push-artifactory helm-chart https://artifactory.rdti.com/artifactory/helm-local
        '''       
      }
    }
  } 
}